<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="http://login2explore.com/jpdb/resources/js/0.0.3/jpdb-commons.js"></script>

    <style>
        *{
            margin: 0;
            padding: 0;
        }
        .employeeForm {
            width: 70%;
            margin: auto;
            height: 100vh;
            margin-top: 3rem;
            box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .warning {
            color: red;
        }
        
#messagesuccess {
    display: block;
    position: fixed;
    height: auto;
   margin: auto;
    bottom: 0px;
    text-align: center;
    width: 100%;
}
.alertsuccessful{
    display: flex;
    justify-content: center;
}
    </style>
</head>

<body>
    <div class="container">
        <div class="employeeForm">
            <h3>Enrollment Form</h3>
            <form method="post">
                <div class="mb-3">
                    <label for="RollNumber" class="form-label"></label>
                    <input type="text" class="form-control" id="RollNumber" placeholder="Roll Number"
                        onchange="checkData()" />
                </div>
                <div id="rollnoHelp" class="form-text warning"></div>
                <div class="input-group">
                    <input type="text" aria-label="First name" class="form-control" placeholder="FirstName"
                        id="firstName" />
                    <input type="text" aria-label="Last name" class="form-control" placeholder="LastName"
                        id="lastName" />
                    <div id="nameHelp" class="form-text warning"></div>
                </div>
                <div class="mb-3">
                    <label for="Class" class="form-label"></label>
                    <input type="number" class="form-control" id="Class" placeholder="Class" />
                    <div id="classHelp" class="form-text warning"></div>
                </div>

                <div class="input-group">
                    <span class="input-group-text">Date Of Birth</span>
                    <input type="date" aria-label="Date Of Birth" class="form-control" id="dob" />
                    <div id="dobHelp" class="form-text warning"></div>
                </div>

                <div class="mb-3">
                    <label for="Address" class="form-label"></label>
                    <input type="text" class="form-control" id="Address" placeholder="Address" />
                    <div id="addressHelp" class="form-text warning"></div>
                </div>
                <div class="mb-3 Enroll">
                    <label for="EnrollmentDate" class="form-label">Enrollment Date</label>
                    <input type="date" id="EnrollmentDate" class="form-control" placeholder="Select  a date"/>
                    <div id="enrollmentDate" class="form-text warning"></div>
                </div>
                <div class="col-auto">
                    <button type="button" class="btn btn-primary" onclick="saveData()" id="SubmitBtn">
                        Submit
                    </button>
                    <button type="button" class="btn btn-primary" onclick="ChangeNow()" id="ChangeBtn">
                        Change
                    </button>
                    <button type="button" class="btn btn-primary" onclick="resetForm()" id="ResetBtn">
                        Reset
                    </button>
                </div>
            </form>
        </div>
    </div>
    <div id="messagesuccess">
        <!-- <div class="alert alert-success" role="alert">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
            <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
          </svg> Message has been Successfully Added
                    </div> -->
    </div>
    <script>
        function showAlert1() {
    let messagesuccess = document.getElementById('messagesuccess');
    messagesuccess.innerHTML = ` <div class="alert alert-success" role="alert" style="text-align:center;background:#68e385; color:#1a3821">
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-check-circle" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
        <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
      </svg> Form has been Successfully Submitted.
                </div>`;
    setTimeout(() => {
        messagesuccess.innerHTML = '';
    }, 2000);
}
function showAlert2() {
    let messagesuccess = document.getElementById('messagesuccess');
    messagesuccess.innerHTML = ` <div class="alert alert-success" role="alert" style="text-align:center;background:#68e385; color:#1a3821">
    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-check-circle" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
        <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
      </svg> Data has been Successfully Changed.
                </div>`;
    setTimeout(() => {
        messagesuccess.innerHTML = '';
    }, 2000);
}

        function removeRequiredTerms() {
            $("#rollnoHelp").text("");
            $("#nameHelp").text("");
            $("#classHelp").text("");
            $("#dobHelp").text("");
            $("#addressHelp").text("");
            $("#enrollmentDate").text("");
        }
        function fillData(data) {
            $("#firstName").val(data.First_Name)
            $("#lastName").val(data.Last_Name)
            $("#Class").val(data.Class)
            $("#dob").val(data.Date_Of_Birth)
            $("#Address").val(data.Address)
            $("#EnrollmentDate").val(data.Enrollment_Date)
        }
        function validateForm() {
            removeRequiredTerms();
            var noerror = true;
            if ($("#RollNumber").val() == "") {
                $("#rollnoHelp").text("required")
                noerror = false;
            }
            if ($("#firstName").val() == "") {
                $("#nameHelp").text("required");
                noerror = false;
            }
            if ($("#Class").val() == "") {
                $("#classHelp").text("required");
                noerror = false;
            }
            if ($("#dob").val() == "") {
                $("#dobHelp").text("required");
                noerror = false;
            }
            if ($("#Address").val() == "") {
                $("#addressHelp").text("required");
                noerror = false;
            }
            if ($("#EnrollmentDate").val() == "") {
                $("#enrollmentDate").text("required");
                noerror = false;
            }
            return noerror;
        }
        function ChangeNow()
        {
            var rollno = $("#RollNumber").val();
            var firstName = $("#firstName").val();
            var lastName = $("lastName").val();
            var Class = $("#Class").val();
            var dob = $("#dob").val();
            var address = $("#Address").val();
            var enrollmentDate = $("#EnrollmentDate").val();
            if (validateForm()) {
                let jsonStrObj = {
                    RollNumber: rollno,
                    First_Name: firstName,
                    Last_Name:lastName,
                    Class: Class,
                    Date_Of_Birth: dob,
                    Address: address,
                    Enrollment_Date: enrollmentDate
                };
              var updatedData=createUPDATERecordRequest("90932449|-31949270577190091|90955362",JSON.stringify(jsonStrObj),"STUDENT-TABLE",
                "SCHOOL-DB", localStorage.getItem("rec_no") )
                jQuery.ajaxSetup({ async: false });
                 var response = executeCommandAtGivenBaseUrl(
                updatedData,
                "http://api.login2explore.com:5577",
                "/api/iml"
            );
            jQuery.ajaxSetup({ async: true });
            resetForm();
            showAlert2();
            }
           
        }
  
        function checkData() {
            var rollNumber = $("#RollNumber").val();
            let jsonStrObj = {
                RollNumber: rollNumber
            };
            var getRequest = createGET_BY_KEYRequest(
                "90932449|-31949270577190091|90955362",
                "STUDENT-TABLE",
                "SCHOOL-DB",
                JSON.stringify(jsonStrObj),
                true,
                true
            );
            jQuery.ajaxSetup({ async: false });
            var studentData = executeCommandAtGivenBaseUrl(
                getRequest,
                "http://api.login2explore.com:5577",
                "/api/irl"
            );
            jQuery.ajaxSetup({ async: true });
            if (studentData.status === 400) {
                $("#SubmitBtn").prop("disabled", false);
                $("#ResetBtn").prop("disabled", false);
                $("#firstName").prop("disabled", false);
                $("#lastName").prop("disabled", false);
                $("#Class").prop("disabled", false);
                $("#dob").prop("disabled", false);
                $("#Address").prop("disabled", false);
                $("#EnrollmentDate").prop("disabled", false);
            } else if (studentData.status === 200) {
                $("#RollNumber").prop("disabled", true);
                $("#ChangeBtn").prop("disabled", false);
                $("#ResetBtn").prop("disabled", false);
                $("#firstName").prop("disabled", false);
                $("#lastName").prop("disabled", false);
                $("#Class").prop("disabled", false);
                $("#dob").prop("disabled", false);
                $("#Address").prop("disabled", false);
                $("#EnrollmentDate").prop("disabled", false);
                $("#firstName").focus();
                fillData(JSON.parse(studentData.data).record);
               localStorage.setItem("rec_no", JSON.parse(studentData.data).rec_no)
            }
        }
        function resetForm() {
            removeRequiredTerms();
            $("#RollNumber").focus();
            $("#firstName").prop("disabled", true);
            $("#lastName").prop("disabled", true);
            $("#Class").prop("disabled", true);
            $("#dob").prop("disabled", true);
            $("#Address").prop("disabled", true);
            $("#EnrollmentDate").prop("disabled", true);
            $("#SubmitBtn").prop("disabled", true);
            $("#ChangeBtn").prop("disabled", true);
            $("#ResetBtn").prop("disabled", true);
            $("#firstName").val("");
            $("#lastName").val("");
            $("#Class").val("");
            $("#dob").val("");
            $("#Address").val("");
            $("#EnrollmentDate").val("");
            $("#RollNumber").prop("disabled", false);
            $("#RollNumber").val("");
        }
        resetForm();
        function saveData() {
            var rollno = $("#RollNumber").val();
            var firstName = $("#firstName").val();
            var lastName = $("lastName").val();
            var Class = $("#Class").val();
            var dob = $("#dob").val();
            var address = $("#Address").val();
            var enrollmentDate = $("#EnrollmentDate").val();
            if (validateForm()) {
                let jsonStrObj = {
                    RollNumber: rollno,
                    First_Name: firstName,
                    Last_Name:lastName,
                    Class: Class,
                    Date_Of_Birth: dob,
                    Address: address,
                    Enrollment_Date: enrollmentDate
                };
                var putRequest = createPUTRequest(
                    "90932449|-31949270577190091|90955362",
                    JSON.stringify(jsonStrObj),
                    "STUDENT-TABLE",
                    "SCHOOL-DB"
                );
                jQuery.ajaxSetup({ async: false });
                executeCommandAtGivenBaseUrl(
                    putRequest,
                    "http://api.login2explore.com:5577",
                    "/api/iml"
                );
                jQuery.ajaxSetup({ async: true });
                resetForm();
                showAlert1();
            }
        }
    </script>
</body>

</html>